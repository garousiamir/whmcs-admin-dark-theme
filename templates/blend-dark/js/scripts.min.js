function toggleadvsearch(){"hidden"==document.getElementById("searchbox").style.visibility?document.getElementById("searchbox").style.visibility="":document.getElementById("searchbox").style.visibility="hidden"}function populate(e){if(d=document.getElementById("searchfield"),v=e.options[e.selectedIndex].value,d){var t=new Array;if(t.clients=["Client ID","Client Name","Company Name","Email Address","Address 1","Address 2","City","State","Postcode","Country","Phone Number","CC Last Four","Notes"],t.orders=["Order ID","Order #","Client Name","Order Date","Amount"],t.services=["Service ID","Domain","Client Name","Product","Billing Cycle","Next Due Date","Status","Username","Dedicated IP","Assigned IPs","Subscription ID","Notes"],t.domains=["Domain ID","Domain","Client Name","Registrar","Expiry Date","Status","Subscription ID","Notes"],t.invoices=["Invoice #","Client Name","Line Item","Invoice Date","Due Date","Date Paid","Total Due","Status"],t.tickets=["Ticket #","Tag","Subject","Client Name","Email Address"],d.options.length=0,cur=t[e.options[e.selectedIndex].value],cur){d.options.length=cur.length;for(var a=0;a<cur.length;a++)d.options[a].text=cur[a],d.options[a].value=cur[a];"services"!=v&&"domains"!=v&&"clients"!=v||(document.getElementById("searchfield").selectedIndex=1)}}}function scrollToGatewayInputError(){var e=jQuery(".gateway-errors,.assisted-cc-input-feedback").first(),t=e.closest("form");t||(t=jQuery("form").first()),t.find('button[type="submit"],input[type="submit"]').prop("disabled",!1).removeClass("disabled").find("i.fas,i.far,i.fal,i.fab").removeAttr("class").addClass("fas fa-arrow-circle-right").find("span").toggle(),e.length&&elementOutOfViewPort(e[0])&&jQuery("html, body").animate({scrollTop:e.offset().top-50},500)}function elementOutOfViewPort(e){var t=e.getBoundingClientRect(),a={};return a.top=t.top<0,a.left=t.left<0,a.bottom=t.bottom>(window.innerHeight||document.documentElement.clientHeight),a.right=t.right>(window.innerWidth||document.documentElement.clientWidth),a.any=a.top||a.left||a.bottom||a.right,a.any}function updateServerGroups(e){var t="",a=!1;$("#inputServerGroup").find("option:not([value=0])").each(function(){t=$(this).attr("data-server-types"),a=!e||t.indexOf(","+e+",")>-1,a?$(this).attr("disabled",!1):($(this).attr("disabled",!0),$(this).is(":selected")&&$("#inputServerGroup").val("0"))})}function fetchModuleSettings(e,t){var a=!1,i="",n=$("#mode-switch"),r=$("#inputModule").val();return""===r?($("#tblModuleSettings").find("tr").not(":first").remove(),$("#noModuleSelectedRow").removeClass("hidden"),void $("#tblModuleAutomationSettings").find("input[type=radio]").attr("disabled",!0)):(t=t||"simple","simple"!==t&&"advanced"!==t&&(t="simple"),requestedMode=t,$("#tblModuleSettings").addClass("module-settings-loading"),$("#tblModuleAutomationSettings").addClass("module-settings-loading"),$("#tblMetricSettings").addClass("module-settings-loading"),$("#serverReturnedError").addClass("hidden"),$("#moduleSettingsLoader").removeClass("hidden").show(),n.attr("data-product-id",e),WHMCS.http.jqClient.post(window.location.pathname,{action:"module-settings",module:r,servergroup:$("#inputServerGroup").val(),id:e,mode:t},function(e){a=!0,$("#tblModuleSettings").removeClass("module-settings-loading"),$("#tblModuleAutomationSettings").removeClass("module-settings-loading"),$("#tblMetricSettings").removeClass("module-settings-loading"),$("#tblModuleSettings tr").not(":first").remove(),n.parent("div .module-settings-mode").addClass("hidden"),r&&e.error&&($("#serverReturnedErrorText").html(e.error),$("#serverReturnedError").removeClass("hidden")),r&&e.content?($("#noModuleSelectedRow").addClass("hidden"),$("#tblModuleSettings").append(e.content),$("#tblModuleAutomationSettings").find("input[type=radio]").removeAttr("disabled"),"simple"===e.mode?(n.attr("data-mode","advanced").find("span").addClass("hidden").parent().find(".text-advanced").removeClass("hidden"),n.parent("div .module-settings-mode").removeClass("hidden")):"advanced"===e.mode&&"advanced"===requestedMode?(n.attr("data-mode","simple").find("span").addClass("hidden").parent().find(".text-simple").removeClass("hidden"),n.parent("div .module-settings-mode").removeClass("hidden")):n.parent("div .module-settings-mode").addClass("hidden"),e.metrics?($("#metricsConfig").html(e.metrics).show(),$("#tblMetricSettings").removeClass("hidden").show(),$(".metric-toggle").bootstrapSwitch({size:"mini",onColor:"success"}).on("switchChange.bootstrapSwitch",function(e,t){WHMCS.http.jqClient.post($(this).data("url"),"action=toggle-metric&id="+$("#inputProductId").val()+"&module="+r+"&metric="+$(this).data("metric")+"&token="+csrfToken+"&enable="+t)})):$("#tblMetricSettings").hide()):($("#noModuleSelectedRow").removeClass("hidden"),$("#tblModuleAutomationSettings").find("input[type=radio]").attr("disabled",!0)),$("#moduleSettingsLoader").fadeOut(),jQuery('[data-toggle="tooltip"]').tooltip()},"json").always(function(){updateServerGroups(a?r:"")}),i)}function wizardCall(e,t,a){var i="wizard="+$('input[name="wizard"]').val()+"&step="+$('input[name="step"]').val()+"&token="+$('input[name="token"]').val()+"&action="+e+"&"+t;WHMCS.http.jqClient.post("wizard.php",i,a)}function wizardError(e){$(".modal-wizard .wizard-content").css("overflow","hidden"),WHMCS.ui.effects.errorShake($(".info-alert:visible:first").html(e).addClass("alert-danger"))}function wizardStepTransition(e,t){var a=$(".modal-wizard .wizard-step:visible").data("step-number");e?increment=2:increment=1;var i=$(".modal-wizard .wizard-step:visible"),n=a+increment;$("#wizardStep"+n).length?($("#wizardStep"+a).fadeOut("",function(){var e="completed";t?(e="skipped",$("#wizardStepLabel"+a+" i").removeClass("fa-check-circle").addClass("fa-minus-circle")):(i.find(".signup-frm").hide(),i.find(".signup-frm-success").removeClass("hidden"),3==a?i.find(".signup-frm-success").append('<input type="hidden" id="ccGatewayFormSubmitted" name="ccGatewayFormSubmitted" value="1" />'):5==a&&i.find(".signup-frm-success").append('<input type="hidden" id="enomFormSubmitted" name="enomFormSubmitted" value="1" />')),n>0?$("#btnWizardBack").is(":visible")||$("#btnWizardBack").hide().removeClass("hidden").fadeIn("slow"):($("#btnWizardBack").fadeOut("slow"),$("#btnWizardDoNotShow").fadeIn("slow"),$("#btnWizardSkip").fadeOut("slow")),$("#wizardStepLabel"+a).removeClass("current").addClass(e),$(".modal-wizard .wizard-step:visible :input").attr("disabled",!0),$("#wizardStep"+n+" :input").removeAttr("disabled"),$("#wizardStep"+n).fadeIn(),$("#inputWizardStep").val(n),$("#wizardStepLabel"+n).addClass("current")}),$("#wizardStep"+(n+1)).length||($("#btnWizardSkip").fadeOut("slow"),$("#btnWizardBack").fadeOut("slow"),$(".modal-submit").html("Finish"))):$("#modalAjax").modal("hide")}function wizardStepBackTransition(){var e=$(".modal-wizard .wizard-step:visible").data("step-number"),t=parseInt(e)-1;$("#wizardStep"+e).fadeOut("",function(){t<1&&($("#btnWizardBack").fadeOut("slow"),$("#btnWizardDoNotShow").fadeIn("slow"),$("#btnWizardSkip").addClass("hidden")),$(".modal-wizard .wizard-step:visible :input").attr("disabled",!0),$("#wizardStep"+t+" :input").removeAttr("disabled"),$("#wizardStep"+t).fadeIn(),$("#inputWizardStep").val(t),$("#wizardStepLabel"+t).addClass("current"),$("#wizardStepLabel"+e).removeClass("current")})}function fadeoutLoaderAndAllowSubmission(e){e.find(".loader").fadeOut(),e.find(".modal-submit").removeProp("disabled")}function openSetupWizard(){$("#modalFooterLeft").html('<a href="#" id="btnWizardSkip" class="btn btn-link pull-left hidden">Skip Step</a><a href="#" id="btnWizardDoNotShow" class="btn btn-link pull-left">Do not show this again</a></div>'),$("#modalAjaxSubmit").before('<a href="#" id="btnWizardBack" class="btn btn-default hidden">Back</a>'),openModal("wizard.php?wizard=GettingStarted","","Getting Started Wizard","modal-lg","modal-wizard modal-setup-wizard","Next","",!0)}function addInvoicePayment(){addingPayment=!0,jQuery("#modalDuplicateTransaction").modal("hide"),WHMCS.http.jqClient.post("invoices.php",jQuery("#addPayment").serialize()+"&ajax=1",function(e){e.redirectUri&&(window.location=e.redirectUri)})}function cancelAddPayment(){jQuery("#paymentLoading").fadeOut("fast",function(){jQuery("#paymentText").fadeIn("fast"),jQuery("#btnAddPayment").removeAttr("disabled")}),jQuery("#modalDuplicateTransaction").modal("hide")}function openFeatureHighlights(){openModal("whatsnew.php?modal=1","","What's new in Version ...","","modal-feature-highlights","","",!0)}function autoSubmitFormByContainer(e){"undefined"!=typeof noAutoSubmit&&noAutoSubmit!==!1||jQuery("#"+e).find("form:first").submit()}function slugify(e){for(var t="āæåãàáäâảẩấćčçđẽèéëêếēėęīįìíïîłńñœøōõòóöôốớơśšūùúüûưÿžźż·/_,:;–",a="aaaaaaaaaaacccdeeeeeeeeeiiiiiilnnooooooooooossuuuuuuyzzz-------",i=0,n=t.length;i<n;i++)e=e.replace(new RegExp(t.charAt(i),"g"),a.charAt(i));return e.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/&/g,"-and-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-")}function generateBootstrapSwitches(){jQuery(".slide-toggle").bootstrapSwitch(),jQuery(".slide-toggle-mini").bootstrapSwitch({size:"mini"})}function openModal(e,t,a,i,n,r,s,o,d){if(jQuery("#modalAjax .modal-title").html(a),i&&jQuery("#modalAjax").children('div[class="modal-dialog"]').addClass(i),n&&jQuery("#modalAjax").addClass(n),n&&jQuery("#modalAjax").addClass(n),r?(jQuery("#modalAjax .modal-submit").show().html(r),s&&jQuery("#modalAjax .modal-submit").attr("id",s)):jQuery("#modalAjax .modal-submit").hide(),o&&jQuery("#modalAjaxClose").hide(),jQuery("#modalAjax .modal-body").html(""),jQuery("#modalSkip").hide(),jQuery("#modalAjax .modal-submit").prop("disabled",!0),jQuery("#modalAjax").modal("show"),WHMCS.http.jqClient.post(e,t,function(e){updateAjaxModal(e)},"json").fail(function(){jQuery("#modalAjax .modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax .loader").fadeOut()}).always(function(){var e=jQuery("#modalAjax").find("form");s&&e.submit(function(e){return submitIdAjaxModalClickEvent(),!1}),d&&e.data("successDataTable",d)}),s){var l=jQuery("#"+s);l.off("click"),l.on("click",submitIdAjaxModalClickEvent)}}function submitIdAjaxModalClickEvent(){if(!jQuery(this).hasClass("disabled")){var e=!0,t=jQuery(this);if(t.addClass("disabled"),jQuery("#modalAjax .loader").show(),ajaxModalSubmitEvents.length&&jQuery.each(ajaxModalSubmitEvents,function(t,a){var i=window[a];e&&"function"==typeof i&&(e=i())}),!e)return t.removeClass("disabled"),void jQuery("#modalAjax .loader").hide();var a=jQuery("#modalAjax").find("form"),i=jQuery("#modalAjax .modal-body"),n=jQuery(i).find(".admin-modal-error");jQuery(n).slideUp();WHMCS.http.jqClient.post(a.attr("action"),a.serialize(),function(e){a.data("successDataTable")&&(e.successDataTable=a.data("successDataTable")),ajaxModalPostSubmitEvents.length&&jQuery.each(ajaxModalPostSubmitEvents,function(t,i){var n=window[i];"function"==typeof n&&n(e,a)}),updateAjaxModal(e)},"json").fail(function(e){var t=e.responseJSON,a="An error occurred while communicating with the server. Please try again.";t&&t.data?(t=t.data,t.errorMsg?n.length>0?jQuery(n).html(t.errorMsg).slideDown():jQuery.growl.warning({title:t.errorMsgTitle,message:t.errorMsg}):t.data.body?jQuery(i).html(t.body):jQuery(i).html(a)):jQuery(i).html(a),jQuery("#modalAjax .loader").fadeOut()}).always(function(){t.removeClass("disabled")})}}function updateAjaxModal(e){if(e.reloadPage)return void("string"==typeof e.reloadPage?window.location=e.reloadPage:window.location.reload());if(e.successDataTable&&WHMCS.ui.dataTable.getTableById(e.successDataTable,void 0).ajax.reload(),e.redirect&&(window.location=e.redirect),e.successWindow&&"function"==typeof window[e.successWindow]&&window[e.successWindow](),e.dismiss&&dialogClose(),e.successMsg&&jQuery.growl.notice({title:e.successMsgTitle,message:e.successMsg}),e.errorMsg){var t=jQuery("#modalAjax .modal-body .admin-modal-error");t.length>0&&!e.dismiss?jQuery(t).html(e.errorMsg).slideDown():jQuery.growl.warning({title:e.errorMsgTitle,message:e.errorMsg})}if(e.title&&jQuery("#modalAjax .modal-title").html(e.title),e.body?jQuery("#modalAjax .modal-body").html(e.body):e.url&&WHMCS.http.jqClient.post(e.url,"",function(e){jQuery("#modalAjax").find(".modal-body").html(e.body)},"json").fail(function(){jQuery("#modalAjax").find(".modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax").find(".loader").fadeOut()}),e.submitlabel&&(jQuery("#modalAjax .modal-submit").html(e.submitlabel).show(),e.submitId&&jQuery("#modalAjax").find(".modal-submit").attr("id",e.submitId)),e.submitId){var a=jQuery("#"+e.submitId);a.off("click"),a.on("click",submitIdAjaxModalClickEvent)}e.disableSubmit?disableSubmit():enableSubmit()}function dialogSubmit(){jQuery("#modalAjax .modal-submit").prop("disabled",!0),jQuery("#modalAjax .loader").show();var e=jQuery("#modalAjax").find("form").attr("action");WHMCS.http.jqClient.post(e,jQuery("#modalAjax").find("form").serialize(),function(e){updateAjaxModal(e)},"json").fail(function(){jQuery("#modalAjax .modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax .loader").fadeOut()})}function dialogClose(){jQuery("#modalAjax").modal("hide")}function addAjaxModalSubmitEvents(e){e&&ajaxModalSubmitEvents.push(e)}function removeAjaxModalSubmitEvents(e){if(e){var t=ajaxModalSubmitEvents.indexOf(e);t>=0&&ajaxModalSubmitEvents.splice(t,1)}}function addAjaxModalPostSubmitEvents(e){e&&ajaxModalPostSubmitEvents.push(e)}function removeAjaxModalPostSubmitEvents(e){if(e){var t=ajaxModalPostSubmitEvents.indexOf(e);t>=0&&ajaxModalPostSubmitEvents.splice(t,1)}}function disableSubmit(){jQuery("#modalAjax .modal-submit").prop("disabled",!0),jQuery("#modalAjax .loader").show()}function enableSubmit(){jQuery("#modalAjax .loader").fadeOut(),jQuery("#modalAjax .modal-submit").removeProp("disabled")}function refreshWidget(e,t){var a=$('.panel[data-widget="'+e+'"]'),i=a.find(".panel-body"),n=a.find("i.fa-sync");i.addClass("panel-loading");WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/refresh&widget="+e+"&"+t),function(e){i.html(e.widgetOutput),i.removeClass("panel-loading")},"json").always(function(){n.removeClass("fa-spin")})}function loadAutomationStatsForDate(e){$("#statsContainer").css("opacity","0.5"),WHMCS.http.jqClient.post("automationstatus.php","action=stats&date="+e,function(e){$(".widgets-container").html(e.body),$(".day-selector").find(".btn-viewing").html(e.newDate)}).fail(function(){jQuery.growl({title:"",message:"Your session has expired. Please refresh to continue."})}).always(function(){$("#statsContainer").css("opacity","1")})}function refreshGraph(){$("#graphContainer").css("opacity","0.5");WHMCS.http.jqClient.post("automationstatus.php","action=graph&metric="+$(".graph-filter-metric a.active").attr("href")+"&period="+$(".graph-filter-period a.active").attr("href"),function(e){$("#graphContainer").html(e.body)}).fail(function(){jQuery.growl({title:"",message:"Your session has expired. Please refresh to continue."})}).always(function(){$("#graphContainer").css("opacity","1")})}function initDateRangePicker(){jQuery(document).ready(function(){jQuery(".date-picker-search").each(function(e){var t=jQuery(this),a=t.data("opens"),i=t.data("drops"),n=adminJsVars.dateRangePicker.defaultRanges,r=adminJsVars.dateRangeFormat;a&&"undefined"!=typeof a||(a="center"),i&&"undefined"!=typeof i||(i="down"),t.hasClass("future")&&(n=adminJsVars.dateRangePicker.futureRanges),t.daterangepicker({autoUpdateInput:!1,ranges:n,alwaysShowCalendars:!0,opens:a,drops:i,showDropdowns:!0,minYear:adminJsVars.minYear,maxYear:adminJsVars.maxYear,locale:{format:r,applyLabel:adminJsVars.dateRangePicker.applyLabel,cancelLabel:adminJsVars.dateRangePicker.cancelLabel,customRangeLabel:adminJsVars.dateRangePicker.customRangeLabel,monthNames:adminJsVars.dateRangePicker.months,daysOfWeek:adminJsVars.dateRangePicker.daysOfWeek}}).on("apply.daterangepicker",function(e,t){jQuery(this).val(t.startDate.format(adminJsVars.dateRangeFormat)+" - "+t.endDate.format(adminJsVars.dateRangeFormat))}).on("cancel.daterangepicker",function(e,t){jQuery(this).val("")})}),jQuery(".datepick,.date-picker,.date-picker-single").each(function(e){var t=jQuery(this),a=t.data("opens"),i=t.data("drops"),n=adminJsVars.dateRangePicker.defaultSingleRanges,r=adminJsVars.dateRangeFormat,s=!1;a&&"undefined"!=typeof a||(a="center"),i&&"undefined"!=typeof i||(i="down"),t.hasClass("future")&&(n=adminJsVars.dateRangePicker.futureSingleRanges),t.hasClass("time")&&(s=!0,r=adminJsVars.dateTimeRangeFormat,t.hasClass("future")&&(n=adminJsVars.dateRangePicker.futureTimeSingleRanges)),t.daterangepicker({singleDatePicker:!0,autoUpdateInput:!1,ranges:n,alwaysShowCalendars:!0,opens:a,drops:i,showDropdowns:!0,minYear:adminJsVars.minYear,maxYear:adminJsVars.maxYear,timePicker:s,timePickerSeconds:!1,locale:{format:r,customRangeLabel:adminJsVars.dateRangePicker.customRangeLabel,monthNames:adminJsVars.dateRangePicker.months,daysOfWeek:adminJsVars.dateRangePicker.daysOfWeek}}).on("apply.daterangepicker",function(e,t){jQuery(this).data("original-value",t.startDate.format(r)).val(t.startDate.format(r))}).on("cancel.daterangepicker",function(e,t){jQuery(this).val(jQuery(this).data("original-value"))})})})}var blendClientLimits={refs:{primary:"#clientLimitNotification",form:"#clientLimitNotification form",dismiss:"#btnClientLimitNotificationDismiss",dontshow:"#btnClientLimitNotificationDontShowAgain"},init:function(){var e=blendClientLimits;$(e.refs.form).submit(function(t){t.preventDefault(),e.go($(this))}),$(e.refs.dismiss).click(function(t){t.preventDefault(),e.dismiss("clientlimitdismiss")}),$(e.refs.dontshow).click(function(t){t.preventDefault(),e.dismiss("clientlimitdontshowagain")})},dismiss:function(e){$(this.refs.primary).fadeOut(),WHMCS.http.jqClient.post(window.location.href,e+"=1&name="+$(this.refs.primary).find(".panel-title span").html())},go:function(e){var t=e.data("fetchUrl"),a=e.find('button[type="submit"]'),i=a.html();a.css("width",a.css("width")).prop("disabled",!0).html('<i class="fas fa-spinner fa-spin"></i>'),WHMCS.http.jqClient.post(t,e.serialize(),function(t){e.find(".input-license-key").val(t.license_key),e.find(".input-member-data").val(t.member_data),e.off("submit").submit(),a.html(i).removeProp("disabled")},"json")}};$(document).ready(blendClientLimits.init);var blendGlobal={refs:{frmNotes:"#frmMyNotes",modalNotes:"#modalMyNotes"},init:function(){var e=blendGlobal;$(e.refs.frmNotes).submit(function(t){t.preventDefault(),$(e.refs.modalNotes).modal("hide"),WHMCS.http.jqClient.post($(this).attr("action"),$(this).serialize())}),$("div.modal").on("shown.bs.modal",function(){var e=$(this).find("input,button.btn-primary");e.length>0&&$(e).first().focus()})}};$(document).ready(blendGlobal.init);var blendIntelliSearch={activeSearch:!1,typingTimer:null,refs:{body:"body",form:"#intelliSearchForm",value:"#inputIntelliSearchValue",close:"#btnIntelliSearchClose",results:"#intelligentSearchResults",searchResults:"#intelligentSearchResults .search-results",resultheadings:"#intelligentSearchResults h5",expand:"#intelliSearchExpand",realtime:"#intelliSearchRealtime",hideinactive:"#intelliSearchHideInactiveSwitch",expandbtn:"#intelligentSearchResults .search-more-results",searchMoreTpl:'.search-more-results[data-type="placeholder"]'},init:function(){var e=blendIntelliSearch;$(e.refs.value).focus(function(t){e.inputExpand()}),$(e.refs.value).keyup(function(){e.inputKeyUp()}),$(e.refs.form+" form").submit(function(t){t.preventDefault(),e.search()}),$(document).keyup(function(t){27===t.keyCode&&e.close()}),$(e.refs.body).click(function(t){$(e.refs.form).hasClass("active")&&!$(t.target).closest(e.refs.form+","+e.refs.results).length&&e.close()}),$(e.refs.close).click(function(t){e.close()}),$(e.refs.realtime).bootstrapSwitch().on("switchChange.bootstrapSwitch",function(e,t){WHMCS.http.jqClient.post($(this).data("url"),"token="+csrfToken+"&autosearch="+t)}),$(e.refs.hideinactive).bootstrapSwitch().on("switchChange.bootstrapSwitch",function(t,a){var i=a?1:0;$("#intelliSearchHideInactive").attr("value",i),e.search()}),$(e.refs.resultheadings).click(function(t){e.toggleResultSet($(this))}),$(blendIntelliSearch.refs.results+" .collapse-toggle").click(function(e){e.preventDefault(),blendIntelliSearch.toggleAllResultSets()}),$(document).on("click",blendIntelliSearch.refs.expandbtn,function(e){e.preventDefault(),blendIntelliSearch.expandResults($(this),$(this).data("type"))})},inputExpand:function(){var e=$(this.refs.form);if(!e.data("expanded")){var t=e.offset(),a=t.left;t.left-=100,e.data("expanded",!0).data("leftpos",t.left).css({position:"absolute",top:t.top,left:a}).animate({left:t.left},200,function(){$("#btnNavbarToggle").is(":visible")?e.delay(10).queue(function(e){$(this).addClass("active full-width"),e()}):e.addClass("active").css("width",$(window).width()-t.left-5)}),$(this.refs.value).val()&&$(this.refs.results).slideDown()}},inputKeyUp:function(){clearTimeout(this.typingTimer),$(this.refs.value).val().replace(/\s/g,"").length>=3&&$("#intelliSearchRealtime").is(":checked")&&(this.typingTimer=setTimeout(this.search,750))},showLoader:function(){$(this.refs.form).find(".loader").removeClass("fa-search").addClass("fa-spinner fa-spin")},endLoader:function(){$(this.refs.form).find(".loader").addClass("fa-search").removeClass("fa-spinner fa-spin")},resetResults:function(){$(this.refs.searchResults).find("h5").hide().end().find("ul li:not(.template)").remove().end().find(".search-more-results").remove()},getResultTypes:function(){var e=[];return $(".search-results ul").each(function(t){e.push($(this).data("type"))}),e},getResultTarget:function(e){return $(this.refs.searchResults+' ul[data-type="'+e+'"]')},getNumResults:function(e){return this.getResultTarget(e).find("li:not(.template)").length},getTotalResults:function(){var e=$(this.refs.searchResults+" ul");return e.find("li:not(.template)").length},getTemplateByType:function(e){var t=this.getResultTarget(e).find("li.template").clone();return t.removeClass("template"),t},renderResults:function(e,t){if(0!=t.length){var a=this.getTemplateByType(e);$.each(t,function(t,i){if("string"==typeof i)n="<li>"+i+"</li>";else var n=blendIntelliSearch.mergeResultData(a.clone(),i);blendIntelliSearch.addResult(e,n)});var i=this.getNumResults(e);if(this.getResultTarget(e).prev("h5").show().find(".count").html(i),t[0].totalResults>i){var n=t[0].totalResults-i;this.showExpand(e,n)}}},showExpand:function(e,t){var a=$(this.refs.expand).val();a!=e&&(cloneRow=$(this.refs.searchMoreTpl).clone(),cloneRow.attr("data-type",e),cloneRow.removeClass("hidden"),stringValue=cloneRow.html(),stringValue=stringValue.replace(":count",t),cloneRow.html(stringValue),this.addResult(e,cloneRow))},addResult:function(e,t){this.getResultTarget(e).append(t)},mergeResultData:function(e,t){return str=e.html(),$.each(t,function(e,t){str=str.replace(new RegExp("\\["+e+"\\]","g"),t)}),e.html(str)},search:function(e){var t=blendIntelliSearch;t.activeSearch||(t.activeSearch=!0,t.showLoader(),$(t.refs.results).is(":visible")||$(t.refs.results).slideDown(),$(t.refs.expand).val(e),WHMCS.http.jqClient.jsonPost({url:$(t.refs.form+" form").attr("action"),data:$(t.refs.form+" form").serialize(),success:function(e){var a=$(t.refs.expand).val();a||t.resetResults(),$.each(t.getResultTypes(),function(a,i){t.renderResults(i,e[i])}),t.searchComplete(!0)},warning:function(e){$(t.refs.results).find(".search-warning").find(".warning-msg").html(e),t.searchComplete(!1,".search-warning")},error:function(e){t.searchComplete(!1,".error")},fail:function(e){t.searchComplete(!1,".session-expired")}}))},searchComplete:function(e,t){if(e){var a=this.getTotalResults();$(this.refs.results).find(".search-result-count").html(a),t=0===a?".search-no-results":".search-results"}$(this.refs.results).find(".outcome").not(t).hide(),$(this.refs.results).find(t).is(":visible")||$(this.refs.results).find(t).fadeIn(),this.endLoader(),this.activeSearch=!1},expandResults:function(e,t){e.remove(),this.search(t)},close:function(){var e=$(this.refs.form);$(this.refs.results).slideUp(),e.css({width:"",left:$(this.refs.form).data("leftpos")}).removeClass("active full-width").delay(100).queue(function(t){e.css({position:"",top:"",left:""}),t()}).data("expanded",!1),$(".logo").focus(),clearTimeout(this.typingTimer)},toggleResultSet:function(e){var t=e.next("ul");t.is(":visible")?(t.slideUp(),e.addClass("collapsed")):(t.slideDown(),e.removeClass("collapsed"));var a=$(this.refs.results+" h5:visible").length,i=$(this.refs.results+" h5:visible:not(.collapsed)").length,n=$(this.refs.results+" .collapse-toggle");0==i?n.html(n.data("lang-expand")):a==i&&n.html(n.data("lang-collapse"))},toggleAllResultSets:function(){var e=$(this.refs.results+" h5:visible:not(.collapsed)").length,t=$(this.refs.results+" .collapse-toggle");0==e?($(this.refs.results+" ul").slideDown(),$(this.refs.results+" h5").removeClass("collapsed"),t.html(t.data("lang-collapse"))):($(this.refs.results+" ul").slideUp(),$(this.refs.results+" h5").addClass("collapsed"),t.html(t.data("lang-expand")))}};$(document).ready(blendIntelliSearch.init);var blendNav={refs:{toggle:"#btnNavbarToggle",navbar:".navigation",collapse:".navigation .navbar-collapse",collapseMenuItem:".navigation .navbar-collapse li.has-dropdown > a",collapseMenuListItem:".navigation .navbar-collapse li.has-dropdown > ul li:not(.expand) > a",backdrop:"#nav-backdrop"},init:function(){var e=blendNav;$(e.refs.toggle).click(function(t){t.preventDefault(),e.toggleNavbar()}),$(e.refs.collapseMenuItem).click(function(t){$(e.refs.toggle).is(":visible")&&(t.preventDefault(),$(this).parent("li").toggleClass("expanded"))}),$(e.refs.collapseMenuListItem).click(function(){e.toggleNavbar()}),e.fixNavWidths()},toggleNavbar:function(){if($(this.refs.collapse).is(":visible"))$(this.refs.collapse).hide(),$(this.refs.backdrop).remove(),$("html, body").css("overflow","auto"),$(this).removeClass("active");else{var e=$(this.refs.navbar).offset().top+45;$(this.refs.collapse).css({top:e,height:$(window).height()-e}).show(),$(document.createElement("div")).attr("id","nav-backdrop").addClass("modal-backdrop nav-modal-backdrop").css("opacity","0.5").css("position","absolute").css("top",e).appendTo("body"),$("html, body").css("overflow","hidden"),$(this).addClass("active")}},fixNavWidths:function(){$(window).width()>=1260&&$(this.refs.collapse+" > ul > li:not(.bt)").each(function(e){$(this).css("width",$(this).width()+4)})}};$(document).ready(blendNav.init);var blendSidebar={refs:{sidebar:"#sidebar",content:"#contentarea",opener:"#sidebarOpener",closer:"#sidebarClose",collapse:".sidebar-collapse",collapseExpand:"#sidebarCollapseExpand"},init:function(){var e=blendSidebar;$(e.refs.opener).click(function(t){t.preventDefault(),$(this).fadeOut(),$(e.refs.content).removeClass("sidebar-minimized"),$(e.refs.sidebar).delay(400).fadeIn("fast"),WHMCS.http.jqClient.post(whmcsBaseUrl+adminBaseRoutePath+"/search.php","a=maxsidebar")}),$(e.refs.closer).click(function(t){t.preventDefault(),$(e.refs.sidebar).fadeOut("fast",function(){$(e.refs.content).addClass("sidebar-minimized"),$(e.refs.opener).fadeIn()}),WHMCS.http.jqClient.post(whmcsBaseUrl+adminBaseRoutePath+"/search.php","a=minsidebar")}),$(e.refs.collapseExpand).click(function(t){t.preventDefault(),$(this).toggleClass("expanded"),$(e.refs.collapse).slideToggle()})}};$(document).ready(blendSidebar.init),function(e,t){"object"!=typeof e.WHMCS&&(e.WHMCS=t)}(window,{hasModule:function(e){return"undefined"!=typeof WHMCS[e]&&Object.getOwnPropertyNames(WHMCS[e]).length>0},loadModule:function(e,t){if(!this.hasModule(e))if(WHMCS[e]={},"function"==typeof t)t.apply(WHMCS[e]);else for(var a in t)t.hasOwnProperty(a)&&(WHMCS[e][a]={},t[a].apply(WHMCS[e][a]))}}),jQuery(document).ready(function(){jQuery(document).on("click",".disable-on-click",function(){if(jQuery(this).addClass("disabled"),jQuery(this).hasClass("spinner-on-click")){var e=$(this).find("i.fas,i.far,i.fal,i.fab");jQuery(e).removeAttr("class").addClass("fas fa-spinner fa-spin")}})}),function(e){WHMCS.hasModule("adminUtils")||WHMCS.loadModule("adminUtils",e)}(function(){return this.getAdminRouteUrl=function(e){return whmcsBaseUrl+"/index.php?rp="+adminBaseRoutePath+e},this.normaliseStringValue=function(e){return e?e.toLowerCase().replace(/\s/g,"-"):""},this}),function(e){WHMCS.hasModule("http")||WHMCS.loadModule("http",e)}({jqClient:function(){return _getSettings=function(e,t,a,i){return"object"==typeof e?e:("function"==typeof t&&(a=t,t=null),{url:e,data:t,success:a,dataType:i})},this.get=function(e,t,a,i){return WHMCS.http.client.request(jQuery.extend(_getSettings(e,t,a,i),{type:"GET"}))},this.post=function(e,t,a,i){return WHMCS.http.client.request(jQuery.extend(_getSettings(e,t,a,i),{type:"POST"}))},this.jsonGet=function(e){e=e||{},this.get(e.url,e.data,function(t){t.warning?(console.log("[WHMCS] Warning: "+t.warning),"function"==typeof e.warning&&e.warning(t.warning)):t.error?(console.log("[WHMCS] Error: "+t.error),"function"==typeof e.error&&e.error(t.error)):"function"==typeof e.success&&e.success(t)},"json").error(function(t,a){console.log("[WHMCS] Error: "+a),"function"==typeof e.fail&&e.fail(a)}).always(function(){"function"==typeof e.always&&e.always()})},this.jsonPost=function(e){e=e||{},this.post(e.url,e.data,function(t){t.warning?(console.log("[WHMCS] Warning: "+t.warning),"function"==typeof e.warning&&e.warning(t.warning)):t.error?(console.log("[WHMCS] Error: "+t.error),"function"==typeof e.error&&e.error(t.error)):"function"==typeof e.success&&e.success(t)},"json").fail(function(t,a){console.log("[WHMCS] Fail: "+a),"function"==typeof e.fail&&e.fail(a,t)}).always(function(){"function"==typeof e.always&&e.always()})},this},client:function(){var e=["get","post","put","delete"],t=this;return _beforeRequest=function(e){return"undefined"==typeof e.type&&(e.type="GET"),e},this.request=function(e){return e=_beforeRequest(e||{}),jQuery.ajax(e)},jQuery.each(e,function(e,a){t[a]=function(e,t){return function(a){return a=a||{},a.type=e.toUpperCase(),t.request(a)}}(a,t)}),this}}),function(e){WHMCS.hasModule("ui")||WHMCS.loadModule("ui",e)}({confirmation:function(){var e=[];return this.register=function(t){return"undefined"==typeof t&&(t="[data-toggle=confirmation]"),e.indexOf(t)<0&&e.push(t),jQuery(t).confirmation({rootSelector:t}),e},this},dataTable:function(){return this.tables={},this.register=function(){var e=this;jQuery("table.data-driven").each(function(t,a){e.getTableById(a.id,void 0)})},this.getTableById=function(e,t){var a=this,i=jQuery("#"+e);if("undefined"==typeof a.tables[e]){"undefined"==typeof t&&(t={dom:'<"listtable"ift>pl',paging:!1,lengthChange:!1,searching:!1,ordering:!0,info:!1,autoWidth:!0,language:{emptyTable:i.data("lang-empty-table")?i.data("lang-empty-table"):"No records found"}});var n=i.data("ajax-url");"undefined"!=typeof n&&(t.ajax={url:n});var r=i.data("dom");"undefined"!=typeof r&&(t.dom=r);var s=i.data("searching");"undefined"!=typeof s&&(t.searching=s);var o=i.data("responsive");"undefined"!=typeof o&&(t.responsive=o);var d=i.data("ordering");"undefined"!=typeof d&&(t.ordering=d);var l=i.data("order");"undefined"!=typeof l&&l&&(t.order=l);var u=i.data("columns");"undefined"!=typeof u&&u&&(t.columns=u);var c=i.data("auto-width");"undefined"!=typeof c&&(t.autoWidth=c);var f=i.data("paging");"undefined"!=typeof f&&(t.paging=f);var p=i.data("length-change");"undefined"!=typeof p&&(t.lengthChange=p);var m=i.data("page-length");"undefined"!=typeof m&&(t.pageLength=m),a.tables[e]=a.initTable(i,t)}else if("undefined"!=typeof t){var h=a.tables[e],y=h.init(),g=jQuery.extend(y,t);h.destroy(),a.tables[e]=a.initTable(i,g)}return a.tables[e]},this.initTable=function(e,t){var a=e.DataTable(t),i=this;return e.data("on-draw")?a.on("draw.dt",function(t,a){var i=e.data("on-draw");
"function"==typeof window[i]&&window[i](t,a)}):e.data("on-draw-rebind-confirmation")&&a.on("draw.dt",function(e){i.rebindConfirmation(e)}),a},this.rebindConfirmation=function(e){for(var t=this,a=e.target.id,i=WHMCS.ui.confirmation.register(),n=0,r=i.length;n<r;n++)jQuery(i[n]).on("confirmed.bs.confirmation",function(e){e.preventDefault(),WHMCS.http.jqClient.post(jQuery(e.target).data("target-url"),{token:csrfToken}).done(function(e){"success"!==e.status&&"okay"!==e.status||t.getTableById(a,void 0).ajax.reload()})})},this},clipboard:function(){return this.copy=function(e){e.preventDefault();var t=$(e.currentTarget),a=$(t).data("clipboard-target"),i=$(a).parent();try{var n=$("<textarea>").css("position","fixed").css("opacity","0").css("width","1px").css("height","1px").val($(a).val());i.append(n),n.focus().select(),document.execCommand("copy")}finally{n.remove()}t.tooltip({trigger:"click",placement:"bottom"}),WHMCS.ui.toolTip.setTip(t,"Copied!"),WHMCS.ui.toolTip.hideTip(t)},this},toolTip:function(){this.setTip=function(e,t){var a=e.data("bs.tooltip");return"in"!==a.hoverState&&(a.hoverState="in"),e.attr("data-original-title",t),a.show(),a},this.hideTip=function(e){return setTimeout(function(){e.data("bs.tooltip").hide()},2e3)}},jsonForm:function(){return this.managedElements="input,textarea,select",this.initFields=function(e){var t=this;$(e).find(t.managedElements).each(function(){var e=this;$(e).on("keypress change",function(){t.fieldHasError(e)&&t.clearFieldError(e)})})},this.init=function(e){var t=this;t.initFields(e),$(e).on("submit",function(a){a.preventDefault(),a.stopPropagation(),t.clearErrors(e);var i=$(e).parents('.modal[role="dialog"]').first();$(i).length&&($(i).on("show.bs.modal hidden.bs.modal",function(){t.clearErrors(e)}),$(i).on("show.bs.modal",function(){$(e)[0].reset()})),WHMCS.http.client.post({url:$(e).attr("action"),data:$(e).serializeArray()}).done(function(a){t.onSuccess(e,a)}).fail(function(a){t.onError(e,a)}).always(function(a){t.onRequestComplete(e,a)})})},this.initAll=function(){var e=this;$('form[data-role="json-form"]').each(function(){var t=this;e.init(t)})},this.markFieldErrors=function(e,t){var a,i,n=this,r=null;for(var s in t)t.hasOwnProperty(s)&&(r=t[s]),i=n.managedElements.split(",").map(function(e){return e+'[name="'+s+'"]'}).join(","),a=$(e).find(i),r&&($(a).parents(".form-group").addClass("has-error"),$(a).attr("title",r),$(a).tooltip());$(e).find(".form-group.has-error input[title]").first().tooltip("show")},this.fieldHasError=function(e){return $(e).parents(".form-group").hasClass("has-error")},this.clearFieldError=function(e){$(e).tooltip("destroy"),$(e).parents(".form-group").removeClass("has-error")},this.onSuccess=function(e,t){var a=$(e).data("on-success");"function"==typeof a&&a(t.data)},this.onError=function(e,t){t.responseJSON&&t.responseJSON.fields&&"object"==typeof t.responseJSON.fields?this.markFieldErrors(e,t.responseJSON.fields):console.log("Unknown error - please try again later.");var a=$(e).data("on-error");"function"==typeof a&&a(t)},this.clearErrors=function(e){var t=this;$(e).find(t.managedElements).each(function(){t.clearFieldError(this)})},this.onRequestComplete=function(e,t){},this},effects:function(){this.errorShake=function(e){t=t||{};var t=$.extend({direction:"left",distance:8,times:3,speed:90},t);return e.each(function(){var e=$(this),a={position:e.css("position"),top:e.css("top"),bottom:e.css("bottom"),left:e.css("left"),right:e.css("right")};e.css("position","relative");var i="up"===t.direction||"down"===t.direction?"top":"left",n="up"===t.direction||"left"===t.direction?"pos":"neg",r={},s={},o={};r[i]=("pos"===n?"-=":"+=")+t.distance,s[i]=("pos"===n?"+=":"-=")+2*t.distance,o[i]=("pos"===n?"-=":"+=")+2*t.distance,e.animate(r,t.speed);for(var d=1;d<t.times;d++)e.animate(s,t.speed).animate(o,t.speed);e.animate(s,t.speed).animate(r,t.speed/2,function(){e.css(a)})})}}}),function(e){WHMCS.hasModule("form")||WHMCS.loadModule("form",e)}(function(){return this.checkAllBound=!1,this.register=function(){this.checkAllBound||(this.bindCheckAll(),this.checkAllBound=!0)},this.bindCheckAll=function(){var e=".btn-check-all";jQuery("body").on("click",e,function(e){var t=jQuery(e.target),a=jQuery("#"+t.data("checkbox-container")+' input[type="checkbox"]');if(t.data("btn-check-toggle")){var i="Deselect All",n="Select All";t.data("label-text-deselect")&&(i=t.data("label-text-deselect")),t.data("label-text-select")&&(n=t.data("label-text-select")),t.hasClass("toggle-active")?(a.prop("checked",!1),t.text(n),t.removeClass("toggle-active")):(a.prop("checked",!0),t.text(i),t.addClass("toggle-active"))}else t.data("btn-toggle-on")?a.prop("checked",!0):a.prop("checked",!1)})},this.reloadCaptcha=function(e){e||(e=jQuery("#inputCaptchaImage"));var t=jQuery(e).data("src");jQuery(e).attr("src",t+"?nocache="+(new Date).getTime());var a=jQuery("#inputCaptcha");a.length&&a.val("")},this}),function(e){WHMCS.hasModule("selectize")||WHMCS.loadModule("selectize",e)}(function(){return this.clientSearch=function(){var e=function(e,t){return"function"==typeof dropdownSelectClient&&0===jQuery(".selectize-dropdown-content > div").length&&dropdownSelectClient(t(e.id),t(e.name)+(e.companyname?" ("+t(e.companyname)+")":"")+(e.id>0?" - #"+t(e.id):""),t(e.email)),'<div><span class="name">'+t(e.name)+(e.companyname?" ("+t(e.companyname)+")":"")+(e.id>0?" - #"+t(e.id):"")+"</span></div>"},t=".selectize-client-search",a=jQuery(t),i=this,n=[];return a.each(function(){var t=$(this),a={valueField:t.data("value-field"),allowEmptyOption:1===t.data("allow-empty-option"),labelField:"name",render:{item:e},optgroupField:"status",optgroupLabelField:"name",optgroupValueField:"id",optgroups:[{$order:1,id:"active",name:t.data("active-label")},{$order:2,id:"inactive",name:t.data("inactive-label")}],load:i.builder.onLoadEvent(t.data("search-url"),function(e){return{dropdownsearchq:e,clientId:r.currentValue,showNoneOption:1===t.data("allow-empty-option")}}),onChange:function(e){if(e&&"function"==typeof dropdownSelectClient){e=parseInt(e);var t=jQuery(".selectize-dropdown-content div[data-value|='"+e+"']");dropdownSelectClient(e,t.children("span.name").text(),t.children("span.email").text())}}},r=i.clients(t,void 0,a);return r.on("change",i.builder.onChangeEvent(r,"#goButton")),n.push(r)}),n.length>1?n:n[0]},this.userSearch=function(){var e=function(e,t){var a="",i=!isNaN(e.id);return i&&e.id>0&&(a=" - #"+t(e.id)),'<div><span class="name">'+t(e.name)+a+"</span></div>"},t=".selectize-user-search",a=jQuery(t),i=this,n=[];return a.each(function(){var a=$(this),r={valueField:a.data("value-field"),labelField:"name",render:{item:e},preload:!1,load:i.builder.onLoadEvent(a.data("search-url"),function(e){return{token:csrfToken,search:e}})},s=i.users(t,void 0,r);return n.push(s)}),n.length>1?n:n[0]},this.clients=function(e,t,a){var i=this.register(e,t,WHMCS.selectize.optionDecorator.client,a);return i.settings.searchField=["name","email","companyname"],i},this.users=function(e,t,a){var i=this.register(e,t,WHMCS.selectize.optionDecorator.user,a);return i.settings.searchField=["name","email"],i},this.billingContacts=function(e,t,a){var i=this.register(e,t,WHMCS.selectize.optionDecorator.billingContact,a);return i.settings.searchField=["name","email","companyname","address"],i},this.payMethods=function(e,t,a){var i=this.register(e,t,WHMCS.selectize.optionDecorator.payMethod,a);return i.settings.searchField=["description","shortAccountNumber","type","payMethodType"],i},this.html=function(e,t,a){var i=this.register(e,t,function(e,t){return'<div class="item">'+e.html+"</div>"},a);return i.settings.searchField=["html"],i},this.simple=function(e,t,a){var i=this.register(e,t,function(e,t){return'<div class="item">'+e.value+"</div>"},a);return i.settings.searchField=["value"],i},this.register=function(e,t,a,i){var n=this,r=jQuery(e),s=n.builder.init(r,i),o=n.builder.itemDecorator(a);return"undefined"==typeof i?(s.settings.render.item=o,s.settings.render.option=o):"undefined"==typeof i.render?(s.settings.render.item=o,s.settings.render.option=o):("undefined"==typeof i.render.item&&(s.settings.render.item=o),"undefined"==typeof i.render.option&&(s.settings.render.option=o)),this.builder.addOptions(s,t),s},this.optionDecorator={client:function(e,t){var a=t(e.name),i="",n="",r="";return e.companyname&&(i=" ("+t(e.companyname)+")"),n="undefined"==typeof e.descriptor?e.id>0?" - #"+t(e.id):"":t(e.descriptor),e.email&&(r='<span class="email">'+t(e.email)+"</span>"),'<div><span class="name">'+a+i+n+"</span>"+r+"</div>"},user:function(e,t){var a=t(e.name),i="",n="",r=!isNaN(e.id);return i="undefined"==typeof e.descriptor?r&&e.id>0?" - #"+t(e.id):"":t(e.descriptor),r&&e.id>0&&e.email&&(n='<span class="email">'+t(e.email)+"</span>"),'<div><span class="name">'+a+i+"</span>"+n+"</div>"},billingContact:function(e,t){var a=t(e.name),i="",n="",r="",s="";return e.companyname&&(i=" ("+t(e.companyname)+")"),n="undefined"==typeof e.descriptor?e.id>0?" - #"+t(e.id):"":t(e.descriptor),e.email&&(r='<span class="email">'+t(e.email)+"</span>"),e.address&&(s='<span class="email">'+t(e.address)+"</span>"),'<div><span class="name">'+a+i+n+"</span>"+r+s+"</div>"},payMethod:function(e,t){var a="",i="",n="",r="",s="";return e.brandIcon&&(a='<i class="'+e.brandIcon+'"></i>'),e.isDefault&&(n='&nbsp;&nbsp;<i class="fal fa-user-check"></i>'),e.description&&(i=e.description),e.shortAccountNumber&&i.indexOf(e.shortAccountNumber)===-1&&(r="("+t(e.shortAccountNumber)+")"),e.detail1&&(s='<span class="mouse">'+t(e.detail1)+"</span>"),'<div><span class="name"> '+a+"&nbsp;"+i+"&nbsp;"+r+"&nbsp;&nbsp;&nbsp;"+s+"&nbsp;&nbsp;"+n+"</span></div>"}},this.builder={init:function(e,t){var a,i={plugins:["whmcs_no_results"],valueField:"id",labelField:"id",create:!1,maxItems:1,preload:"focus"};"undefined"==typeof t&&(t={}),a=jQuery.extend({},i,t);var n=e.selectize(a);return n=n[0].selectize,n.currentValue="",n.on("focus",function(){n.currentValue=n.getValue(),n.clear()}),n.on("blur",function(){var t=n.getValue(),a=!isNaN(t),i=1;1===e.data("allow-empty-option")&&(i=0),(""===t||a&&t<i)&&n.setValue(n.currentValue)}),n},addOptions:function(e,t){"undefined"!=typeof t&&t.length&&e.addOption(t)},itemDecorator:function(e){return"function"==typeof e?e:"undefined"==typeof e?WHMCS.selectize.optionDecorator.user:void 0},onLoadEvent:function(e,t){return function(a,i){jQuery.ajax({url:e,type:"POST",dataType:"json",data:t(a),error:function(){i()},success:function(e){i(e)}})}},onChangeEvent:function(e,t){var a;return"undefined"!=typeof t&&(a=function(a){var i=jQuery(t);i.length&&!isNaN(e.currentValue)&&e.currentValue>0&&a.length&&a!==e.currentValue&&i.click()}),a}},this}),jQuery(document).ready(function(){jQuery('[data-toggle="tooltip"]').tooltip(),jQuery('[data-toggle="popover"]').popover(),jQuery(".inline-editable").editable({mode:"inline",params:function(e){return e.action="savefield",e.token=csrfToken,e}}),generateBootstrapSwitches(),jQuery("select.form-control.enhanced").select2({theme:"bootstrap"}),jQuery("body").on("click",".copy-to-clipboard",WHMCS.ui.clipboard.copy),jQuery(".credit-card-type li a").click(function(){jQuery("#selectedCard").html(jQuery(this).html()),jQuery("#cctype").val(jQuery("span.type",this).html())}),jQuery(".paging-dropdown li a,.page-selector").click(function(){if(jQuery(this).hasClass("disabled"))return!1;var e=jQuery("#frmRecordsFound");return jQuery("#currentPage").html(jQuery(this).data("page")),e.find('input[name="page"]').val(jQuery(this).data("page")).end(),e.submit(),!1}),jQuery(".no-results a").click(function(e){e.preventDefault(),jQuery("#checkboxShowHidden").bootstrapSwitch("state",!1)}),jQuery("body").on("click","a.autoLinked",function(e){if(e.preventDefault(),jQuery(this).hasClass("disabled"))return!1;var t=window.open();t.opener=null,t.location=$(this).attr("href")}),jQuery("#tblModuleSettings").on("click",".icon-refresh",function(){fetchModuleSettings(jQuery(this).data("product-id"),"simple")}),jQuery("#mode-switch").click(function(){fetchModuleSettings(jQuery(this).data("product-id"),jQuery(this).attr("data-mode"))}),$("body").on("click",".modal-wizard .modal-submit",function(){var e=$("#modalAjax");e.find(".loader").show(),e.find(".modal-submit").prop("disabled",!0),$(".modal-wizard .wizard-step:hidden :input").attr("disabled",!0);var t=document.forms.namedItem("frmWizardContent"),a=new FormData(t),n=$(".modal-wizard .wizard-step:visible").data("step-number"),r=$("#ccGatewayFormSubmitted").val(),s=$("#enomFormSubmitted").val(),o=new XMLHttpRequest;r&&3==n||s&&5==n?(wizardStepTransition(!1,!0),fadeoutLoaderAndAllowSubmission(e)):(o.open("POST",$("#frmWizardContent").attr("action"),!0),o.send(a),o.onload=function(){if(200==o.status)try{var t=JSON.parse(o.responseText),a=$("#btnWizardDoNotShow");if(a.is(":visible")&&a.fadeOut("slow",function(){$("#btnWizardSkip").hide().removeClass("hidden").fadeIn("slow")}),t.success){if(t.approveremails)for(i=0;i<t.approveremails.length;i++){var n=t.approveremails[i];$(".modal-wizard .cert-approver-emails").append('<label class="radio-inline"><input type="radio" name="approver_email" value="'+n+'"> '+n+"</label><br>")}else t.fileAuth?($(".modal-wizard .cert-further-instructions").hide(),$(".modal-wizard .cert-file-auth").removeClass("hidden"),$(".modal-wizard .wizard-transition-step .icon").hide(),$(".modal-wizard .wizard-transition-step .title").addClass("file-auth"),$(".modal-wizard .wizard-transition-step .icon.file-auth").removeClass("hidden").show(),$(".modal-wizard .cert-file-auth-filename").val(t.fileAuthFilename),$(".modal-wizard .cert-file-auth-contents").val(t.fileAuthContents)):t.refreshMc&&$("#btnMcServiceRefresh").click();wizardStepTransition(t.skipNextStep,!1)}else wizardError(t.error)}catch(e){wizardError("An error occurred while communicating with the server. Please try again.")}finally{fadeoutLoaderAndAllowSubmission(e)}else alert("An error occurred while communicating with the server. Please try again."),e.find(".loader").fadeOut()})}).on("click","#btnWizardSkip",function(e){e.preventDefault();var t=$("#inputWizardStep").val(),a=!1;"2"!==t&&"4"!==t||(a=!0),wizardStepTransition(a,!0)}).on("click","#btnWizardBack",function(e){e.preventDefault(),wizardStepBackTransition()}).on("click","#btnWizardDoNotShow",function(e){e.preventDefault(),WHMCS.http.jqClient.post("wizard.php","dismiss=true",function(){$("#modalAjax").modal("hide")})}),$("#modalAjax").on("hidden.bs.modal",function(e){$("#modalAjax").hasClass("modal-wizard")&&($("#btnWizardSkip").remove(),$("#btnWizardBack").remove(),$("#btnWizardDoNotShow").remove())}),$("#prodsall").click(function(){var e=$(".checkprods");e.filter(":visible").prop("checked",$(this).prop("checked")).end(),$(this).prop("checked")&&e.filter(":hidden").prop("checked",!$(this).prop("checked")).end()}),$("#addonsall").click(function(){var e=$(".checkaddons");e.filter(":visible").prop("checked",$(this).prop("checked")).end(),$(this).prop("checked")&&e.filter(":hidden").prop("checked",!$(this).prop("checked")).end()}),$("#domainsall").click(function(){var e=$(".checkdomains");e.filter(":visible").prop("checked",$(this).prop("checked")).end(),$(this).prop("checked")&&e.filter(":hidden").prop("checked",!$(this).prop("checked")).end()}),jQuery("#addPayment").submit(function(e){e.preventDefault(),addingPayment=!1,jQuery("#btnAddPayment").attr("disabled","disabled"),jQuery("#paymentText").hide(),jQuery("#paymentLoading").removeClass("hidden").show();var t=jQuery(this).serialize().replace("action=edit","action=checkTransactionId"),a=WHMCS.http.jqClient.post("invoices.php",t+"&ajax=1");a.done(function(e){0==e.unique?jQuery("#modalDuplicateTransaction").modal("show"):addInvoicePayment()})}),$("#modalDuplicateTransaction").on("hidden.bs.modal",function(){addingPayment===!1&&jQuery("#paymentLoading").hide("fast",function(){jQuery("#paymentText").show("fast"),jQuery("#btnAddPayment").removeAttr("disabled")})}),jQuery(document).on("click",".feature-highlights-content .btn-action-1, .feature-highlights-content .btn-action-2",function(){var e=jQuery(this).data("link"),t=jQuery(this).data("link-title");WHMCS.http.jqClient.post("whatsnew.php",{action:"link-click",linkId:e,linkTitle:t,token:csrfToken})}),"undefined"!=typeof mentionsFormat&&jQuery('#replynote[name="message"],#note[name="note"]').atwho({at:"@",displayTpl:'<li class="mention-list">${gravatar} ${username} - ${name} (${email})</li>',insertTpl:mentionsFormat,data:WHMCS.adminUtils.getAdminRouteUrl("/mentions"),limit:5}),jQuery(".search-bar .search-icon").click(function(e){jQuery(".search-bar").find("input:first").focus()}),jQuery(".btn-search-advanced").click(function(e){jQuery(this).closest(".search-bar").find(".advanced-search-options").slideToggle("fast")}),WHMCS.ui.dataTable.register(),WHMCS.ui.confirmation.register();var e=jQuery("#mcConfigureProductPromos");if(e.length){var t=e.find(".item").length;e.owlCarousel({loop:!0,margin:10,responsiveClass:!0,responsive:{0:{items:1},850:{items:t<2?t:2},1250:{items:t<3?t:3},1650:{items:t<4?t:4}}}),jQuery("#dismissPromos").on("click",function(){e.slideUp("fast"),jQuery(this).hide(),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/dismiss-marketconnect-promo"),{token:csrfToken},function(e){})})}jQuery(document).on("submit","#frmCreditCardDeleteDetails",function(e){e.preventDefault(),jQuery("#modalAjax .modal-submit").prop("disabled",!0),jQuery("#modalAjax .loader").show(),$("#remoteFailureDetails").slideUp(),WHMCS.http.jqClient.post(jQuery(this).attr("action"),jQuery(this).serialize(),function(e){e.error?($("#remoteFailureDetails").find(".alert").html(e.errorMsg).end().slideDown(),jQuery("#modalAjax .loader").fadeOut()):updateAjaxModal(e)},"json").fail(function(){jQuery("#modalAjax .modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax .loader").fadeOut()})}),jQuery(".captcha-type").length&&jQuery(document).on("change",".captcha-type",function(){var e=jQuery(".recaptchasetts");""===jQuery(this).val()?e.hide():e.show()}),jQuery("#frmClientSearch").length&&jQuery(document).on("change",".status",function(){jQuery("#status").val(jQuery(this).val())}),jQuery(".ssl-state.ssl-sync").each(function(){var e=jQuery(this);WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/domains/ssl-check"),{domain:e.data("domain"),userid:e.data("user-id"),token:csrfToken},function(t){e.replaceWith('<img src="'+t.image+'" data-toggle="tooltip" title="'+t.tooltip+'" class="'+t.class+'">'),jQuery('[data-toggle="tooltip"]').tooltip()})}),function(e){e.fn.setInputError=function(e){return this.parents(".form-group").addClass("has-error").find(".field-error-msg").text(e),this}}(jQuery),function(e){e.fn.showInputError=function(){return this.parents(".form-group").addClass("has-error").find(".field-error-msg").show(),this}}(jQuery),jQuery(".datatable .view-detail").click(function(e){e.preventDefault(),$currentRow=jQuery(this).closest("tr");var t='<i class="fa fa-spinner fa-spin"></i> Loading...';if(jQuery(this).hasClass("expanded"))$currentRow.next("tr.detail-row").hide(),jQuery(this).removeClass("expanded").find("i").removeClass("fa-minus").addClass("fa-plus");else{var a=$currentRow.find("td").length;if(jQuery(this).hasClass("data-loaded"))$currentRow.next("tr.detail-row").show();else{$currentRow.after('<tr class="detail-row"><td colspan="'+a+'">'+t+"</td></tr>");WHMCS.http.jqClient.jsonGet({url:jQuery(this).attr("href"),success:function(e){$currentRow.next("tr.detail-row").remove(),$currentRow.after('<tr class="detail-row"><td colspan="'+a+'">'+e.output+"</td></tr>")}})}jQuery(this).find("i").addClass("fa-minus").removeClass("fa-plus"),jQuery(this).addClass("expanded").addClass("data-loaded")}}),jQuery(document).on("change",".toggle-display",function(){var e=jQuery(this).data("show"),t=jQuery("."+e);jQuery(document).find("div.toggleable").hide(),t.hasClass("hidden")&&t.removeClass("hidden"),t.show()}),jQuery(document).on("click","button.disable-submit",function(e){var t=jQuery(this),a=t.closest("form");t.prepend('<i class="fas fa-spinner fa-spin"></i> ').addClass("disabled").prop("disabled",!0),a.submit()}),jQuery("#btnResendVerificationEmail").click(function(){var e=$(this);e.prop("disabled",!0).html('<i class="fa fa-spinner fa-spin fa-fw"></i> '+e.html()),WHMCS.http.jqClient.jsonPost({url:window.location.href,data:{token:csrfToken,action:"resendVerificationEmail",userid:e.data("clientid")},success:function(t){t.success?e.html(e.data("successmsg")):e.html(e.data("errormsg"))}})}),"undefined"!=typeof Selectize&&Selectize.define("whmcs_no_results",function(e){var t=this;this.search=function(){var e=t.search;return function(){var t=e.apply(this,arguments),a=function(e){return isNaN(e.id)||e.id>0},i=t.items.filter(function(e){return a(e)}),n=t.items.filter(function(e){return!a(e)});return i.length>0?t.items=i:n.length>0&&(t.items=[n[0]]),t}}()})});var addingPayment=!1,ajaxModalSubmitEvents=[],ajaxModalPostSubmitEvents=[];jQuery(document).ready(function(){jQuery(document).on("click",".open-modal",function(e){e.preventDefault();var t=jQuery(this).attr("href"),a=jQuery(this).data("modal-size"),i=jQuery(this).data("modal-class"),n=jQuery(this).data("modal-title"),r=jQuery(this).data("btn-submit-id"),s=jQuery(this).data("btn-submit-label"),o=jQuery(this).data("btn-close-hide"),d=jQuery(this).attr("disabled"),l=jQuery(this).data("datatable-reload-success");d||openModal(t,"",n,a,i,s,r,o,l)}),jQuery("#modalAjax").on("hidden.bs.modal",function(e){if(jQuery(this).hasClass("modal-feature-highlights")){var t=jQuery("#cbFeatureHighlightsDismissForVersion").is(":checked");WHMCS.http.jqClient.post("whatsnew.php",{dismiss:"1",until_next_update:t?"1":"0",token:csrfToken})}jQuery("#modalAjax").find(".modal-body").empty(),jQuery("#modalAjax").children("div.modal-dialog").removeClass("modal-lg"),jQuery("#modalAjax").removeClass().addClass("modal whmcs-modal fade"),jQuery("#modalAjax .modal-title").html("Title"),jQuery("#modalAjax .modal-submit").html("Submit").removeClass().addClass("btn btn-primary modal-submit").removeAttr("id").removeAttr("disabled"),jQuery("#modalAjax .loader").show()})}),jQuery(document).ready(function(){var e=jQuery(".selectize-multi-select"),t=jQuery(".selectize-select"),a=jQuery(".selectize-promo"),i=jQuery(".selectize-tags"),n=jQuery(".selectize-newTicketCc,.selectize-ticketCc"),r="";jQuery(e).selectize({plugins:["remove_button"],valueField:jQuery(e).attr("data-value-field"),labelField:"name",searchField:"name",allowEmptyOption:!0,create:!1,maxItems:null,render:{item:function(e,t){return'<div><span class="name">'+t(e.name)+"</span></div>"},option:function(e,t){return'<div><span class="name">'+t(e.name)+"</span></div>"}},onItemRemove:function(e){"multi-view"==jQuery(this)[0].$input[0].id&&"any"!=e&&"flagged"!=e&&jQuery(this)[0].removeItem("any",!0)}}),jQuery(t).selectize({valueField:jQuery(t).attr("data-value-field"),labelField:"name",searchField:"name",allowEmptyOption:jQuery(t).attr("data-allow-empty-option"),create:!1,maxItems:1,render:{item:function(e,t){var a="";return"undefined"!=typeof e.colour&&"#FFF"!==e.colour&&(a=' style="background-color: '+t(e.colour)+';"'),"<div"+a+'><span class="name">'+t(e.name)+"</span></div>"},option:function(e,t){var a="";return"undefined"!=typeof e.colour&&"#FFF"!==e.colour&&(a=' style="background-color: '+t(e.colour)+';"'),"<div"+a+'><span class="name">'+t(e.name)+"</span></div>"}},onFocus:function(){r=this.getValue(),this.clear()},onBlur:function(){""==this.getValue()&&this.setValue(r),jQuery(t).hasClass("selectize-auto-submit")&&r!==this.getValue()&&(this.setValue(this.getValue()),jQuery(t).parent("form").submit())}}),jQuery(a).selectize({valueField:jQuery(a).attr("data-value-field"),labelField:"name",searchField:"name",allowEmptyOption:jQuery(a).attr("data-allow-empty-option"),create:!1,maxItems:1,render:{item:function(e,t){var a="",i=e.name.split(" - ");return"undefined"!=typeof e.colour&&"#FFF"!==e.colour&&""!==e.colour&&(a=' style="background-color: '+t(e.colour)+';"'),"undefined"!=typeof otherPromos&&e.optgroup===otherPromos&&""!==r?jQuery("#nonApplicablePromoWarning").show():jQuery("#nonApplicablePromoWarning").hide(),i[1]?"<div"+a+"><strong>"+t(i[0])+'</strong><small style="overflow: hidden"> - '+t(i[1])+"</small></div>":"<div"+a+">"+t(i[0])+"</div>"},option:function(e,t){var a="",i=e.name.split(" - ");return"undefined"!=typeof e.colour&&"#FFF"!==e.colour&&""!==e.colour&&(a=' style="background-color: '+t(e.colour)+';"'),i[1]?"<div"+a+"><strong>"+t(i[0])+"</strong><br />"+t(i[1])+"</div>":"<div"+a+">"+t(i[0])+"</div>"}},onFocus:function(){this.$control.parent("div").css("overflow","visible"),r=this.getValue(),this.clear()},onBlur:function(){this.$control.parent("div").css("overflow","hidden"),""===this.getValue()&&(this.setValue(r),updatesummary()),jQuery(a).hasClass("selectize-auto-submit")&&r!==this.getValue()&&(this.setValue(this.getValue()),jQuery(a).parent("form").submit())}}),jQuery(i).selectize({plugins:["remove_button"],valueField:"text",searchField:["text"],delimiter:",",persist:!1,create:function(e){return{value:e,text:e}},render:{item:function(e,t){return'<div><span class="item">'+t(e.text)+"</span></div>"},option:function(e,t){return'<div><span class="item">'+t(e.text)+"</span></div>"}},load:function(e,t){return e.length?void jQuery.ajax({url:window.location.href,type:"POST",dataType:"json",data:{action:"gettags",q:e,token:csrfToken},error:function(){t()},success:function(e){t(e)}}):t()},onItemAdd:function(e){jQuery.ajax({url:window.location.href,type:"POST",data:{action:"addTag",newTag:e,token:csrfToken}}).success(function(){jQuery.growl.notice({title:"",message:"Saved successfully!"})})},onItemRemove:function(e){jQuery.ajax({url:window.location.href,type:"POST",data:{action:"removeTag",removeTag:e,token:csrfToken}}).success(function(){jQuery.growl.notice({title:"",message:"Saved successfully!"})})}}),jQuery(n).selectize({plugins:["remove_button"],valueField:"text",searchField:["text"],delimiter:",",persist:!0,create:function(e){return{value:e,text:e,name:e,iconclass:""}},render:{item:function(e,t){var a="";return a="undefined"!=typeof e.iconclass&&e.iconclass.length>0?'<span style="padding-right: 8px"><i class="'+t(e.iconclass)+'"></i></span>'+t(e.name):t(e.name),'<div class="selectize"><span class="name">'+a+"</span></div>"},option:function(e,t){var a="";return a="undefined"!=typeof e.iconclass&&e.iconclass.length>0?'<span style="padding-right: 8px"><i class="'+t(e.iconclass)+'"></i></span>'+t(e.name):t(e.name),'<div class="selectize"><span class="name">'+a+'</span><span class="email">'+t(e.text)+"</span></div>"}}})}),$(document).ready(function(){function e(){WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/order"),{token:csrfToken,order:packery.getPositions()},function(e){},"json").always(function(){o=!1,packery.shiftLayout()})}var t=null;"undefined"!=typeof Storage&&(t=JSON.parse(localStorage.getItem("minimisedWidgets"))),t||(t=[]),$(".widget-minimise").click(function(e){e.preventDefault();var a=$(this),i=a.find("i"),n=a.closest(".panel").data("widget");i.hasClass("fa-chevron-up")?(a.closest(".panel").find(".panel-body").slideUp("fast",function(){i.removeClass("fa-chevron-up").addClass("fa-chevron-down"),packery.shiftLayout()}),t.indexOf(n)==-1&&t.push(n)):(a.closest(".panel").find(".panel-body").slideDown("fast",function(e){i.removeClass("fa-chevron-down").addClass("fa-chevron-up"),packery.fit(this),packery.shiftLayout()}),t.splice(t.indexOf(n),1)),"undefined"!=typeof Storage&&localStorage.setItem("minimisedWidgets",JSON.stringify(t))}),$(".widget-refresh").click(function(e){e.preventDefault();var t=$(this),a=t.find("i"),i=t.closest(".panel").data("widget");t.closest(".panel").find(".panel-body");a.addClass("fa-spin"),refreshWidget(i,"refresh=1")});var a=!1;if($(".widget-hide").click(function(e){e.preventDefault();var t=$(this),i=t.closest(".panel").data("widget");a=!0,$("#panel"+i).slideUp("fast",function(){$(this).addClass("hidden"),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/display/toggle/"+i)).always(function(){$('input[data-widget="'+i+'"]').iCheck("uncheck"),a=!1}),$(".home-widgets-container").masonry().masonry("reloadItems")})}),$(document).on("ifToggled",".display-widget",function(e){var t=$(this),i=$(this).data("widget"),n=$("#panel"+i);a||(t.iCheck("disable"),t.prop("checked")?n.hasClass("hidden")&&(t.parent("div").parent("label").parent("li").addClass("active"),n.hide().removeClass("hidden").slideDown("fast",function(){WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/display/toggle/"+i)).always(function(){$(".home-widgets-container").masonry().masonry("reloadItems"),n.find(".widget-refresh").click(),$("#widgetSettingsDropdown").hasClass("open")===!1&&$("#widgetSettings").dropdown("toggle"),t.iCheck("enable")})})):n.hasClass("hidden")===!1&&(t.parent("div").parent("label").parent("li").removeClass("active"),n.slideUp("fast",function(){$(this).addClass("hidden"),$(".home-widgets-container").masonry().masonry("reloadItems"),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/display/toggle/"+i),function(){$("#widgetSettingsDropdown").hasClass("open")===!1&&$("#widgetSettings").dropdown("toggle")},"json").always(function(){t.iCheck("enable")})})))}),$("input.display-widget").each(function(){var e=$(this),t=e.next();t.text();t.remove(),e.iCheck({inheritID:!0,checkboxClass:"icheckbox_flat-blue",increaseArea:"20%"})}),$(".home-widgets-container").length){t.forEach(function(e){$("#panel"+e).find(".panel-body").hide().end().find("i.fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down")}),Packery.prototype.getPositions=function(){return this.items.map(function(e){return e.element.getAttribute("data-widget")})},grid=document.querySelector(".home-widgets-container"),packery=new Packery(grid,{itemSelector:".dashboard-panel-item",columnWidth:".dashboard-panel-sizer",percentPosition:!0}),packery.stamp(document.querySelector(".dashboard-panel-static-item"));for(var i=grid.querySelectorAll(".dashboard-panel-item"),n=0;n<i.length;n++){var r=i[n],s=new Draggabilly(r,{handle:".panel-title"});packery.bindDraggabillyEvents(s)}packery.on("removeComplete",function(){packery.shiftLayout()});var o=!1;packery.on("dragItemPositioned",function(t){packery.shiftLayout(),$(".home-widgets-container").children("div.dashboard-panel-item").hasClass("is-dragging")||o||(o=!0,setTimeout(function(){e()},1e3))})}});var grid,packery;$(document).ready(function(){$("#statsContainer").on("click",".btn-viewing",function(e){e.preventDefault()}),$("#graphContainer").on("click",".graph-filter-metric a",function(e){e.preventDefault(),$(".graph-filter-metric a").removeClass("active"),$(this).addClass("active"),refreshGraph()}),$("#graphContainer").on("click",".graph-filter-period a",function(e){e.preventDefault(),$(".graph-filter-period a").removeClass("active"),$(this).addClass("active"),refreshGraph()})}),jQuery(document).ready(function(){var e=jQuery(".database-backups");e.find(".activate").on("click",function(){var e=jQuery(this),t=e.parent("form"),a=e.data("type"),i=t.serialize();e.prop("disabled",!0).addClass("disabled"),i+="&action=save&activate=1&type="+a+"&token="+csrfToken,WHMCS.http.jqClient.post(window.location.href,i,function(i){i.success===!0?(jQuery.growl.notice({title:i.successMessageTitle,message:i.successMessage}),t.find(".save, .deactivate-start").removeClass("hidden"),e.addClass("hidden"),jQuery("#"+a+"Label").toggleClass("label-default label-success").text(i.activeText)):jQuery.growl.error({title:i.errorMessageTitle,message:i.errorMessage})},"json").always(function(){e.prop("disabled",!1).removeClass("disabled")})}),e.find(".save").on("click",function(){var e=jQuery(this),t=e.parent("form"),a=e.data("type"),i=t.serialize();e.prop("disabled",!0).addClass("disabled"),i+="&action=save&type="+a+"&token="+csrfToken,WHMCS.http.jqClient.post(window.location.href,i,function(e){e.success===!0?jQuery.growl.notice({
title:e.successMessageTitle,message:e.successMessage}):jQuery.growl.error({title:e.errorMessageTitle,message:e.errorMessage})},"json").always(function(){e.prop("disabled",!1).removeClass("disabled")})}),e.find(".test").on("click",function(){var e=jQuery(this),t=e.parent("form"),a=e.data("type"),i=t.serialize();e.prop("disabled",!0).addClass("disabled"),jQuery("#"+a+"Container").removeClass("hidden"),i+="&action=test&type="+a+"&token="+csrfToken,jQuery("#"+a+"Test").hide().removeClass("hidden alert-success alert-danger").addClass("alert-default").find(".extra-text").addClass("hidden").text("").end().find(".default-text").removeClass("hidden").end().slideDown("fast"),WHMCS.http.jqClient.post(window.location.href,i,function(e){e.success===!0?(jQuery("#"+a+"Test").addClass("alert-success").removeClass("alert-default alert-danger").find(".default-text").addClass("hidden").end().find(".extra-text").text(e.successMessage).removeClass("hidden").end().delay(3e3).slideUp("slow"),t.find(".activate").prop("disabled",!1).removeClass("disabled")):jQuery("#"+a+"Test").addClass("alert-danger").removeClass("alert-default alert-success").find(".default-text").addClass("hidden").end().find(".extra-text").text(e.errorMessageTitle+": "+e.errorMessage).removeClass("hidden").end().delay(3e3).slideUp("slow")},"json").always(function(){e.prop("disabled",!1).removeClass("disabled"),jQuery("#"+a+"Container").addClass("hidden")})}),e.find(".deactivate-start").on("click",function(){var e=jQuery(this),t=(e.parent("form"),e.data("type")),a=jQuery("#modalConfirmDeactivate");jQuery("#confirmDeactivateYes").data("type",t),a.modal("show")}),jQuery("#modalConfirmDeactivate").find(".deactivate").on("click",function(){var e=jQuery(this),t=jQuery("#modalConfirmDeactivate"),a=(t.parent("form"),e.data("type")),i="action=deactivate&type="+a+"&token="+csrfToken,n=jQuery('.deactivate-start[data-type="'+a+'"]').parent("form");e.prop("disabled",!0).addClass("disabled"),WHMCS.http.jqClient.post(window.location.href,i,function(e){e.success===!0?(jQuery.growl.notice({title:e.successMessageTitle,message:e.successMessage}),n.find(".save, .deactivate-start").addClass("hidden"),n.find(".activate").removeClass("hidden").prop("disabled",!0),"email"===a&&n.find(".activate").prop("disabled",!1),jQuery("#"+a+"Label").toggleClass("label-default label-success").text(e.inactiveText)):jQuery.growl.error({title:e.errorMessageTitle,message:e.errorMessage})},"json").always(function(){e.prop("disabled",!1).removeClass("disabled"),t.modal("hide")})}),e.find("#inputDestination").on("change",function(){var e=jQuery("#destinationData"),t=jQuery(this).val();"homedir"!==t&&e.hasClass("hidden")?e.hide().removeClass("hidden").slideDown("fast"):"homedir"!==t||e.hasClass("hidden")||e.slideUp("fast").addClass("hidden")})}),initDateRangePicker(),jQuery(document).ready(function(){function e(){if(a){var r=jQuery("button.retry:eq("+n+")");if(!r.length)return clearTimeout(i),i=null,void t.removeAttr("disabled").removeClass("disabled").find("i").removeClass("fa-spin").end();r.click()}i=setTimeout(e,1e3)}var t=jQuery("button.retry-all");if(t.length){var a=!1,i=null,n=0;jQuery("button.retry").click(function(){a=!1;var e=jQuery(this),t=jQuery(this).data("entry-id"),r=jQuery("div#processing-entry-"+t);e.attr("disabled","disabled").addClass("disabled").find("i").addClass("fa-spin").end(),i?r.find("div.queued").hide().end().find("div.processing").show().end():r.find("div.messages").children("div").hide().end().find("div.processing").show().end().end().hide().removeClass("hidden").slideDown("fast");var s=WHMCS.http.jqClient.post(window.location.pathname,{token:csrfToken,action:"retry",id:t},null,"json");s.done(function(a){a.error&&(r.find("div.processing").hide().end().find("div.error").find("span").html(a.message).parent().show().end(),jQuery("#last-error-"+t).html(a.errorMessage),jQuery("div#entry-"+t).find("small.last-attempt").find("span").html(a.lastAttempt),e.removeAttr("disabled").removeClass("disabled").find("i").removeClass("fa-spin").end(),n++),a.completed&&(jQuery("div#entry-"+t).find("div.action-buttons").find("button").removeClass("retry").attr("disabled","disabled").addClass("disabled").find("i.fa-spin").removeClass("fa-spin").end(),r.find("div.processing").slideUp("fast").end().find("div.success").slideDown("fast").end())}),s.always(function(){a=!0})}),jQuery("button.resolve").click(function(){var e=jQuery(this),t=jQuery(this).data("entry-id"),a=jQuery("div#processing-entry-"+t);e.attr("disabled","disabled").addClass("disabled"),a.find("div.messages").children("div").hide().end().find("div.processing").show().end().end().hide().removeClass("hidden").slideDown("fast");var i=WHMCS.http.jqClient.post(window.location.pathname,{token:csrfToken,action:"resolve",id:t},null,"json");i.done(function(i){i.completed?(jQuery("div#entry-"+t).find("div.action-buttons").find("button").removeClass("retry").attr("disabled","disabled").addClass("disabled").end(),a.find("div.processing").slideUp("fast").end().find("div.success").find("span").html(i.message).parent().slideDown("fast").end()):(a.find("div.processing").slideUp("fast").end().find("div.error").find("span").html(i.message).parent().slideDown("fast").end(),e.removeAttr("disabled").removeClass("disabled"))})}),t.click(function(){jQuery(this).attr("disabled","disabled").addClass("disabled").find("i").addClass("fa-spin").end();var t=jQuery("button.retry");a=!0,n=0,t.each(function(e){var t=jQuery(this).data("entry-id");jQuery("div#processing-entry-"+t).find("div.messages").children("div").hide().end().find("div.queued").show().end().end().hide().removeClass("hidden").slideDown("fast")}),i=setTimeout(e,1e3)})}}),jQuery(document).ready(function(){jQuery(document).on("click","#btnMcServiceRefresh",function(e){e.preventDefault();var t=$(this);t.find("i").addClass("fa-spin"),WHMCS.http.jqClient.post({url:"clientsservices.php",data:t.attr("href")+"&token="+csrfToken,success:function(e){$("#mcServiceManagementWrapper").replaceWith(e.statusOutput),t.find("i").removeClass("fa-spin")}})}),jQuery(document).on("click","#btnMcCancelOrder",function(e){swal({title:"Are you sure?",html:!0,text:'Cancelling this order will result in the service immediately ceasing to function.<br><br>You will automatically receive a credit if within the credit period. <a href="https://go.whmcs.com/1281/marketconnect-credit-terms" target="_blank">See credit period terms</a>',type:"warning",showCancelButton:!0,confirmButtonText:"Yes, cancel it",cancelButtonText:"No"},function(){runModuleCommand("terminate")})}),jQuery(document).on("click","#mcServiceManagementWrapper .btn:not(.open-modal,.btn-refresh,.btn-cancel)",function(e){e.preventDefault(),$("#growls").fadeOut("fast").remove(),$(".successbox,.errorbox").slideUp("fast").remove();var t=$(this),a=t.attr("href"),i=t.find("i"),n=i.attr("class");"disabled"!==t.attr("disabled")&&(i.removeClass().addClass("fas fa-spin fa-spinner"),WHMCS.http.jqClient.post("clientsservices.php",a+"&token="+csrfToken,function(e){e.redirectUrl?window.open(e.redirectUrl):e.growl&&("error"==e.growl.type?$.growl.error({title:"",message:e.growl.message}):($.growl.notice({title:"",message:e.growl.message}),$("#btnMcServiceRefresh").click())),i.removeClass().addClass(n)},"json"))})}),jQuery(document).ready(function(){if("undefined"!=typeof customCountryData){var e=$.fn.intlTelInput.getCountryData();for(var t in customCountryData)if(customCountryData.hasOwnProperty(t)){var a=customCountryData[t];if(codeLower=t.toLowerCase(),a===!1){for(var i=0;i<e.length;i++)if(codeLower===e[i].iso2){e.splice(i,1);break}}else e.push({name:a.name,iso2:codeLower,dialCode:a.callingCode,priority:0,areaCodes:null})}}if(jQuery("body").data("phone-cc-input")){var n=jQuery('input[name^="phone"], input[name$="phone"], input[name="domaincontactphonenumber"]').not('input[type="hidden"]');if(n.length){var r=jQuery('[name^="country"], [name$="country"]'),s="us";r.length&&(s=r.val().toLowerCase(),"um"===s&&(s="us")),n.each(function(){var e=jQuery(this),t=e.attr("name");"domaincontactphonenumber"===t&&(s=jQuery('[name="domaincontactcountry"]').val().toLowerCase()),jQuery(this).before('<input id="populatedCountryCode'+t+'" type="hidden" name="country-calling-code-'+t+'" value="" />'),e.intlTelInput({preferredCountries:[s,"us","gb"].filter(function(e,t,a){return a.indexOf(e)===t}),initialCountry:s,autoPlaceholder:"polite",separateDialCode:!0}),e.on("countrychange",function(e,a){jQuery("#populatedCountryCode"+t).val(a.dialCode),jQuery(this).val()==="+"+a.dialCode&&jQuery(this).val("")}),e.on("blur keydown",function(e){if("blur"===e.type||"keydown"===e.type&&13===e.keyCode){var t=jQuery(this).intlTelInput("getNumber"),a=jQuery(this).intlTelInput("getSelectedCountryData"),i="+"+a.dialCode;0===t.indexOf(i)&&(t.match(/\+/g)||[]).length>1&&(t=t.substr(i.length)),jQuery(this).intlTelInput("setNumber",t)}}),jQuery("#populatedCountryCode"+t).val(e.intlTelInput("getSelectedCountryData").dialCode),r.on("change",function(){if(""===e.val()){var t=jQuery(this).val().toLowerCase();"um"===t&&(t="us"),n.intlTelInput("setCountry",t)}}),e.attr("data-initial-value",$(e).val()),e.parents("form").find("input[type=reset]").each(function(){var e=this,t=$(e).parents("form");$(e).data("phone-handler")||($(e).data("phone-handler",!0),$(e).click(function(e){return e.stopPropagation(),$(t).trigger("reset"),$(t).find("input[data-initial-value]").each(function(){var e=this;$(e).val($(e).attr("data-initial-value"))}),!1}))})}),n.parents("div.form-group").find(".field-icon").hide().end(),n.removeClass("field").addClass("form-control")}var o=jQuery('input[name$="][Phone Number]"], input[name$="][Phone]"]').not('input[type="hidden"]');o.length&&jQuery.each(o,function(e,t){var a=jQuery(this),i=a.attr("name");i=i.replace("contactdetails[","").replace("][Phone Number]","").replace("][Phone]","");var n=jQuery('[name$="'+i+'][Country]"]'),r=n.val().toLowerCase();"um"===r&&(r="us"),a.before('<input id="populated'+i+'CountryCode" type="hidden" name="contactdetails['+i+'][Phone Country Code]" value="" />'),a.intlTelInput({preferredCountries:[r,"us","gb"].filter(function(e,t,a){return a.indexOf(e)===t}),initialCountry:r,autoPlaceholder:"polite",separateDialCode:!0}),a.on("countrychange",function(e,t){jQuery("#populated"+i+"CountryCode").val(t.dialCode),jQuery(this).val()==="+"+t.dialCode&&jQuery(this).val("")}),a.on("blur keydown",function(e){if("blur"===e.type||"keydown"===e.type&&13===e.keyCode){var t=jQuery(this).intlTelInput("getNumber"),a=jQuery(this).intlTelInput("getSelectedCountryData"),i="+"+a.dialCode;0===t.indexOf(i)&&(t.match(/\+/g)||[]).length>1&&(t=t.substr(i.length)),jQuery(this).intlTelInput("setNumber",t)}}),jQuery("#populated"+i+"CountryCode").val(a.intlTelInput("getSelectedCountryData").dialCode),n.on("blur",function(){if(""===a.val()){var e=jQuery(this).val().toLowerCase();"um"===e&&(e="us"),a.intlTelInput("setCountry",e)}})})}});